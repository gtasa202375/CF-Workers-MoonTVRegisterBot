# CF-Workers-MoonTVRegisterBot

ğŸ¤– åŸºäº Cloudflare Workers çš„ MoonTV ç”¨æˆ·æ³¨å†Œ Telegram æœºå™¨äºº

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªè¿è¡Œåœ¨ Cloudflare Workers å¹³å°ä¸Šçš„ Telegram æœºå™¨äººï¼Œç”¨äº MoonTV å¹³å°çš„ç”¨æˆ·æ³¨å†Œç®¡ç†ã€‚æœºå™¨äººæ”¯æŒç”¨æˆ·è‡ªåŠ¨æ³¨å†Œã€å¯†ç ä¿®æ”¹ç­‰åŠŸèƒ½ï¼Œå¹¶é€šè¿‡ Redis æ•°æ®åº“è¿›è¡Œæ•°æ®æŒä¹…åŒ–å­˜å‚¨ã€‚

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- ğŸ” **ç”¨æˆ·æ³¨å†Œ**ï¼šç¾¤ç»„æˆå‘˜å¯ä»¥é€šè¿‡æœºå™¨äººå¿«é€Ÿæ³¨å†Œè´¦æˆ·
- ğŸ”‘ **å¯†ç ç®¡ç†**ï¼šæ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ä¿®æ”¹è®¿é—®å¯†ç 
- ğŸ‘¥ **ç¾¤ç»„éªŒè¯**ï¼šç¡®ä¿åªæœ‰æŒ‡å®šç¾¤ç»„æˆå‘˜æ‰èƒ½ä½¿ç”¨æ³¨å†ŒåŠŸèƒ½
- ğŸ’¾ **æ•°æ®æŒä¹…åŒ–**ï¼šä½¿ç”¨ Redis æ•°æ®åº“å­˜å‚¨ç”¨æˆ·æ•°æ®
- âš¡ **æ— æœåŠ¡å™¨éƒ¨ç½²**ï¼šåŸºäº Cloudflare Workers å¹³å°ï¼Œæ— éœ€ç®¡ç†æœåŠ¡å™¨
- ğŸ›¡ï¸ **å®‰å…¨é…ç½®**ï¼šæ”¯æŒç¯å¢ƒå˜é‡é…ç½®ï¼Œä¿æŠ¤æ•æ„Ÿä¿¡æ¯

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- **å¹³å°**ï¼šCloudflare Workers
- **è¯­è¨€**ï¼šJavaScript (ES6+)
- **æ•°æ®åº“**ï¼šRedis (Upstash)
- **API**ï¼šTelegram Bot API
- **éƒ¨ç½²å·¥å…·**ï¼šWrangler CLI

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç¯å¢ƒå‡†å¤‡

ç¡®ä¿ä½ å·²ç»å®‰è£…äº† Node.js å’Œ npmï¼š

```bash
node --version
npm --version
```

### 2. å…‹éš†é¡¹ç›®

```bash
git clone https://github.com/cmliu/CF-Workers-MoonTVRegisterBot.git
cd CF-Workers-MoonTVRegisterBot
```

### 3. å®‰è£…ä¾èµ–

```bash
npm install
```

### 4. é…ç½®ç¯å¢ƒå˜é‡

åœ¨ `wrangler.toml` æ–‡ä»¶ä¸­é…ç½®å¿…è¦çš„ç¯å¢ƒå˜é‡ï¼š

```toml
[vars]
REDIS_URL = "your-redis-url"
BOT_TOKEN = "your-telegram-bot-token"
TOKEN = "your-webhook-token"
GROUP_ID = "your-telegram-group-id"
```

### 5. éƒ¨ç½²åˆ° Cloudflare Workers

```bash
npm run deploy
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡

| å˜é‡å | æè¿° | å¿…éœ€ | ç¤ºä¾‹å€¼ |
|--------|------|------|--------|
| `BOT_TOKEN` | Telegram Bot Token | âœ… | `123456:ABC-DEF1234ghIkl-zyx57W2v1u123ew11` |
| `GROUP_ID` | Telegram ç¾¤ç»„ IDï¼Œç”¨äºé‰´æƒï¼Œä»…å…è®¸ç¾¤ç»„æˆå‘˜æ³¨å†Œ | âœ… | `-1001234567890` |
| `REDIS_URL` | Redis è¿æ¥ URL | âœ… | `rediss://user:pass@host:6379` |
| `TOKEN` | Webhook åˆå§‹åŒ–ä»¤ç‰Œ | âœ… | `your-secret-token` |

### Telegram Bot è®¾ç½®

1. é€šè¿‡ [@BotFather](https://t.me/botfather) åˆ›å»ºæ–°çš„ Telegram Bot
2. è·å– Bot Token
3. å°†æœºå™¨äººæ·»åŠ åˆ°ç›®æ ‡ç¾¤ç»„
4. è·å–ç¾¤ç»„ ID

## ğŸ¤– æœºå™¨äººå‘½ä»¤

| å‘½ä»¤ | åŠŸèƒ½ | ç”¨æ³•ç¤ºä¾‹ |
|------|------|----------|
| `/start` | æ³¨å†Œæ–°ç”¨æˆ·æˆ–æŸ¥çœ‹ç”¨æˆ·ä¿¡æ¯ | `/start` |
| `/pwd` | ä¿®æ”¹è®¿é—®å¯†ç  | `/pwd æ–°å¯†ç ` |

## ğŸ“± ä½¿ç”¨æµç¨‹

1. **åŠ å…¥ç¾¤ç»„**ï¼šç”¨æˆ·å¿…é¡»å…ˆåŠ å…¥æŒ‡å®šçš„ Telegram ç¾¤ç»„
2. **å¼€å§‹æ³¨å†Œ**ï¼šå‘æœºå™¨äººå‘é€ `/start` å‘½ä»¤
3. **è‡ªåŠ¨åˆ›å»ºè´¦æˆ·**ï¼šç³»ç»Ÿè‡ªåŠ¨åˆ›å»ºç”¨æˆ·è´¦æˆ·ï¼Œåˆå§‹å¯†ç ä¸ºç”¨æˆ· ID
4. **ä¿®æ”¹å¯†ç **ï¼ˆå¯é€‰ï¼‰ï¼šä½¿ç”¨ `/pwd æ–°å¯†ç ` å‘½ä»¤ä¿®æ”¹å¯†ç 

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
CF-Workers-MoonTVRegisterBot/
â”œâ”€â”€ _worker.js          # ä¸»è¦çš„ Worker ä»£ç 
â”œâ”€â”€ package.json        # é¡¹ç›®é…ç½®æ–‡ä»¶
â”œâ”€â”€ wrangler.toml      # Cloudflare Workers é…ç½®
â”œâ”€â”€ README.md          # é¡¹ç›®æ–‡æ¡£
â””â”€â”€ .gitignore         # Git å¿½ç•¥æ–‡ä»¶
```

## ğŸ”§ å¼€å‘æŒ‡å—

### æœ¬åœ°å¼€å‘

```bash
# å¯åŠ¨æœ¬åœ°å¼€å‘æœåŠ¡å™¨
npm run dev
```

### é¢„è§ˆéƒ¨ç½²

```bash
# é¢„è§ˆéƒ¨ç½²æ•ˆæœ
npm run preview
```

### å®Œæ•´éƒ¨ç½²

```bash
# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
npm run deploy
```

## ğŸ“‹ æ•°æ®ç»“æ„

### Redis æ•°æ®æ ¼å¼

- **ç”¨æˆ·å¯†ç **ï¼š`u:{userId}:pwd` â†’ ç”¨æˆ·å¯†ç 
- **ç®¡ç†é…ç½®**ï¼š`admin:config` â†’ JSON æ ¼å¼çš„é…ç½®ä¿¡æ¯

### é…ç½®æ•°æ®ç»“æ„

```json
{
  "UserConfig": {
    "AllowRegister": false,
    "Users": [
      {
        "username": "123456789",
        "role": "user"
      }
    ]
  }
}
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **å®‰å…¨æ€§**ï¼šè¯·ç¡®ä¿ Redis è¿æ¥ä½¿ç”¨åŠ å¯†è¿æ¥ï¼ˆrediss://ï¼‰
2. **æƒé™æ§åˆ¶**ï¼šæœºå™¨äººåªå…è®¸æŒ‡å®šç¾¤ç»„çš„æˆå‘˜ä½¿ç”¨
3. **å¯†ç å¼ºåº¦**ï¼šå¯†ç é•¿åº¦è‡³å°‘ä¸º 6 ä½å­—ç¬¦
4. **é”™è¯¯å¤„ç†**ï¼šæ‰€æœ‰ API è°ƒç”¨éƒ½åŒ…å«é”™è¯¯å¤„ç†æœºåˆ¶

## ğŸ› æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **éƒ¨ç½²å¤±è´¥**ï¼šæ£€æŸ¥ `wrangler.toml` é…ç½®æ ¼å¼æ˜¯å¦æ­£ç¡®
2. **æœºå™¨äººæ— å“åº”**ï¼šç¡®è®¤ Bot Token å’Œ Webhook é…ç½®æ­£ç¡®
3. **æ•°æ®åº“è¿æ¥å¤±è´¥**ï¼šæ£€æŸ¥ Redis URL å’Œè®¤è¯ä¿¡æ¯

### é”™è¯¯ç è¯´æ˜

- `500`ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯
- `403`ï¼šæƒé™ä¸è¶³ï¼ˆç”¨æˆ·ä¸åœ¨æŒ‡å®šç¾¤ç»„ï¼‰
- `400`ï¼šè¯·æ±‚å‚æ•°é”™è¯¯

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

1. Fork æœ¬é¡¹ç›®
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. æäº¤æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. æ¨é€åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. åˆ›å»º Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ‘¨â€ğŸ’» ä½œè€…

- [@cmliu](https://github.com/cmliu)

## ğŸ™ è‡´è°¢

- [Cloudflare Workers](https://workers.cloudflare.com/) - æ— æœåŠ¡å™¨å¹³å°
- [Telegram Bot API](https://core.telegram.org/bots/api) - æœºå™¨äºº API
- [Upstash](https://upstash.com/) - Redis æ•°æ®åº“æœåŠ¡

---

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·é€šè¿‡ [Issues](https://github.com/cmliu/CF-Workers-MoonTVRegisterBot/issues) è”ç³»æˆ‘ä»¬ã€‚
